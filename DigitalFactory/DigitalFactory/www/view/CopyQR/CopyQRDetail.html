<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>数字工厂 - 红狮</title>
    <!-- Bootstrap CSS CDN -->
    <!-- Bootstrap core CSS -->
    <link href="../../lib/bootstrap/css/bootstrap-reboot.min.css" rel="stylesheet">
    <link href="../../lib/bootstrap/css/bootstrap-grid.min.css" rel="stylesheet">
    <link href="../../lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="../../css/style.css">
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="../../lib/mCustomScrollbar/jquery.mCustomScrollbar.min.css">
    <!-- Font Awesome JS -->
    <link href="../../lib/font-awesome/css/all.css" rel="stylesheet">
    <!--<script defer src="../../lib/font-awesome/js/all.js"></script>-->

</head>

<body onload="onload()">
    <script src="../../scripts/jquery.js"></script>
    <script type="text/javascript">
        function onload() {
            var login = window.localStorage.a;
            if (login != 1) {
                setTimeout(function () {
                    alert("请先登录");
                    location.href = "../../index.html";
                }, 1000);
            }
            url = window.location.href.split("?")[1];
            //console.log(url);
            $.ajax({
                type: "get",
                contentType: "application/json",
                url: "http://192.168.9.49/api/Receipt/GetRecordByID?ReceiptID=" + url +"",
                //data: data,
                //dataType: 'json',
                error: function (xhr, status, p3, p4) {
                    //console.log(xhr);
                    var err = "Error " + " " + status + " " + p3;
                    if (xhr.responseText && xhr.responseText[0] == "{")
                        err = JSON.parse(xhr.responseText).message;
                    alert("CopyQRDeatail ParseQRValues，" + err);
                },
                success: function (result) {
                    document.getElementById('Company').value = result[0]["Company"];
                    document.getElementById('Partnum').value = result[0]["PartNum"];
                    document.getElementById('Partdescription').value = result[0]["PartDesc"];
                    document.getElementById('BatchNo').value = result[0]["BatchNo"];
                    document.getElementById('Jobnum').value = result[0]["JobNum"];
                    document.getElementById('AssmbelNum').value = result[0]["AssemblySeq"];
                    document.getElementById('SupplierNo').value = result[0]["SupplierNo"];
                    document.getElementById('POnum').value = result[0]["PoNum"];
                    document.getElementById('POline').value = result[0]["PoLine"];
                    document.getElementById('receiveQty').value = result[0]["ReceiveQty1"];
                    document.getElementById('POrelnum').value = result[0]["PORelNum"];
                    document.getElementById('Jobseq').value = result[0]["Jobseq"];
                    document.getElementById('HeatNum').value = result[0]["HeatNum"];
                    document.getElementById('plant').value = result[0]["Plant"];
                    document.getElementById('SupplierName').value = result[0]["SupplierName"];
                }
            });

        }
        $(document).ready(function () {
            $("#sidebar").mCustomScrollbar({
                theme: "minimal"
            });

            $('#dismiss, .overlay').on('click', function () {
                $('#sidebar').removeClass('active');
                $('.overlay').removeClass('active');
            });

            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').addClass('active');
                $('.overlay').addClass('active');
                $('.collapse.in').toggleClass('in');
                $('a[aria-expanded=true]').attr('aria-expanded', 'false');
            });
            $("#sidebar1").load("../../header.html");
        });
        function signout() {
            $.ajax({
                type: "get",
                contentType: "application/json",
                url: "http://192.168.9.49/api/Receipt/SignOut",
                //data: "{'value':1}",
                dataType: 'json',
                error: function (ex) {
                    alert("Signout，" + ex.error + ",请关闭程序重新打开");
                    return;
                },
                success: function (result) {
                    window.localStorage.clear();
                    location.href = "../../index.html";
                }
            });
        }
        function Copy() {
            var companyid = $("#Company").val();
            var SupplierNo = $("#SupplierNo").val();
            var POnum = parseInt($("#POnum").val());
            var POline = parseInt($("#POline").val());
            var POrelnum = parseInt($("#POrelnum").val());
            var Partnum = $("#Partnum").val();
            var Partdescription = $("#Partdescription").val();
            var BatchNo = $("#BatchNo").val();
            var HeatNum = $("#HeatNum").val();
            var Jobnum = $("#Jobnum").val();
            var receiveQty = $("#receiveQty").val();
            var JobSeq = $("#Jobseq").val();
            var AssemblySeq = $("#AssmbelNum").val();

            var data = "{'Company': '" + companyid + "', 'SupplierNo': '" + SupplierNo + "', 'PoNum': " + POnum + ", 'PoLine': " + POline + ", 'PORelNum': " + POrelnum +
                ", 'PartNum': '" + Partnum + "', 'PartDesc': '" + Partdescription + "', 'BatchNo': '" + BatchNo + "', 'HeatNum': '" + HeatNum + "', 'JobNum': '" + Jobnum +
                "', 'ReceiveQty1': " + receiveQty + ",'JobSeq':'" + JobSeq + "','AssemblySeq':'" + AssemblySeq + "'}";
            console.log(data);
            $.ajax({
                type: "post",
                contentType: "application/json",
                url: "http://192.168.9.49/api/Receipt/PrintQR",
                data: data,
                //dataType: 'json',
                error: function (xhr, status, p3, p4) {
                    //console.log(xhr);
                    var err = "Error " + " " + status + " " + p3;
                    if (xhr.responseText && xhr.responseText[0] == "{")
                        err = JSON.parse(xhr.responseText).message;
                    alert("复制失败，" + err + ",请尝试重新登录");
                },
                success: function (result) {

                    if (result == "处理成功") {
                        alert(result);
                        window.location.href = './view/Receipt/CopyQR.html';
                    }
                    else {
                        alert(result);
                        window.location.reload();
                    }
                }
            });

        }
    </script>
    <!-- Sidebar  -->
    <div id="sidebar1">
    </div>
    <!-- Page Content  -->
    <div class="content">
        <header>
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container-fluid">
                    <a class="navbar-brand mr-auto mr-lg-0" href="#">红狮数字工厂</a>

                    <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse"
                            data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                            aria-label="Toggle navigation">
                        <i class="fas fa-align-justify"></i>
                    </button>
                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i>
                        <!-- <span>Toggle Sidebar</span> -->
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item active">
                                <a class="nav-link" onclick="signout()">退出</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
        <main role="main" class="container">
            <div class="row">
                <input type="text" style="display:none" id="Jobseq">
                <input type="text" style="display:none" id="AssmbelNum">
                <div class="col-md-12 order-md-1">
                    <h4 class="mb-3">操作</h4>
                    <!--<form>-->
                    <fieldset disabled>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">公司</label>
                                <input type="text" class="form-control" id="Company" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">供应商编号</label>
                                <input type="text" class="form-control" id="SupplierNo" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">供应商名称</label>
                                <input type="text" class="form-control" id="SupplierName" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">收件日期</label>
                                <input type="text" class="form-control" id="ReceiptDate" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">采购单号</label>
                                <input type="text" class="form-control" id="POnum" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">采购单行号</label>
                                <input type="text" class="form-control" id="POline" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">发货行</label>
                                <input type="text" class="form-control" id="POrelnum" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">物料编码</label>
                                <input type="text" class="form-control" id="Partnum" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">物料描述</label>
                                <input type="text" class="form-control" id="Partdescription" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">批次号</label>
                                <input type="text" class="form-control" id="BatchNo" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">工厂</label>
                                <input type="text" class="form-control" id="plant" placeholder="" value="" required="">
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">工单号</label>
                                <input type="text" class="form-control" id="Jobnum" placeholder="" value="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">炉批号</label>
                                <input type="text" class="form-control" id="HeatNum" placeholder="" value="">
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">接收数量</label>
                                <input type="text" class="form-control" id="receiveQty" placeholder="" value="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="lastName">备注</label>
                                <input type="text" class="form-control" id="Remark" placeholder="" value="">
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    
                    <hr class="mb-4">

                    <hr class="mb-4">
                    <button class="btn btn-primary btn-lg btn-block" type="submit" onclick="Copy()">复制</button>
                    <!--</form>-->
                </div>
            </div>
        </main>
        <footer class="site-footer footer pt-5 text-muted text-center text-small">
            <div class="container">
                <div class="text-center">
                    <p>
                        © Copyrights <strong>HS</strong>. All Rights Reserved
                    </p>
                    <!-- <div class="credits">
                            Created with Dashio template by <a href="https://templatemag.com/">TemplateMag</a>
                        </div> -->
                    <a href="#" class="go-top">
                        <i class="fas fa-angle-up"></i>
                    </a>
                </div>
            </div>
        </footer>

    </div>

    <div class="overlay"></div>
    <!-- jQuery CDN - Slim version (=without AJAX) -->
    <!--<script src="lib/jquery/jquery-3.3.1.slim.min.js"></script>-->
    <!-- Popper.JS -->
    <script src="../../lib/popper.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="../../lib/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery Custom Scroller CDN -->
    <script src="../../lib/mCustomScrollbar/jquery.mCustomScrollbar.concat.min.js"></script>

</body>

</html>